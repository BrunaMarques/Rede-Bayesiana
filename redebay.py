import numpy as np
import pandas as pd
from IPython.display import Image

from pgmpy.models import BayesianModel
from pgmpy.factors.discrete import TabularCPD
from pgmpy.estimators import MaximumLikelihoodEstimator
from pgmpy.inference import VariableElimination
from pgmpy.estimators import BayesianEstimator

df = pd.read_csv('mushrooms.csv')
model = BayesianModel([('cap-surface', 'odor'), ('spore-print-color', 'odor'), ('spore-print-color', 'gill-attachment'), ('odor', 'bruises'), ('odor', 'gill-size'),('odor', 'ring-type'),('odor', 'class'),('ring-type','class'), ('ring-type', 'bruises'), ('spore-print-color', 'class'), ('habitat', 'gill-attachment'), ('gill-color', 'ring-type'), ('gill-color', 'gill-size'), ('gill-color', 'class'), ('gill-color', 'gill-attachment')])

mle = MaximumLikelihoodEstimator(model, df)

# print('cap-surface')
# print(mle.estimate_cpd('cap-surface')) 
# print('spore-print-color')
# print(mle.estimate_cpd('spore-print-color')) 
# print('habitat')
# print(mle.estimate_cpd('habitat')) 
# print('gill-color')
# print(mle.estimate_cpd('gill-color')) 
# print('odor')
# print(mle.estimate_cpd('odor')) 
# print('ring type')
# print(mle.estimate_cpd('ring-type')) 
# print('bruises')
# print(mle.estimate_cpd('bruises')) 
# print('gill size')
# print(mle.estimate_cpd('gill-size')) 
# print('gill attachment')
# print(mle.estimate_cpd('gill-attachment')) 
# print('class')
# print(mle.estimate_cpd('class')) 


cpd_cap_surface = TabularCPD(variable='cap-surface', variable_card=4, values= [[0.285574 ], [0.000492368], [0.314623],[0.399311]])

cpd_spore_print_color = TabularCPD(variable='spore-print-color', variable_card=9, 
                     values= [[0.00590842], [0.200886], [0.230428], [0.242245], [0.00590842], [0.00886263], [0.00590842], [0.293944], [0.00590842]])


cpd_habitat = TabularCPD(variable='habitat', variable_card=7, 
                    values= [[0.387494], [0.264402], [0.102413], [0.0359429], [0.140817], [0.0452979], [0.0236337]])

cpd_gill_color = TabularCPD(variable='gill-color', variable_card=12, 
                    values= [[0.212703], [0.0118168], [0.0925652 ], [0.0901034], [0.0502216], [0.129], [0.00787789], [0.183653], [0.00295421], [0.0605613], [0.147957], [0.0105859]])

cpd_odor = TabularCPD(variable='odor', variable_card=9, 
                   values= [[0.1111111111111111  ,0.0, 0.0, 0.016129032258064516,0.1111111111111111  ,0.1111111111111111  ,0.5, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.14814814814814814 ,0.15079365079365079 ,0.0, 0.0, 0.5, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.15555555555555556 ,0.15555555555555556 ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.1111111111111111],
                            [0.1111111111111111, 0.0, 0.06666666666666667 ,0.06451612903225806 ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.09523809523809523 ,0.0, 0.0, 0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.1111111111111111],
                            [0.1111111111111111  ,1.0, 0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2553191489361702  ,0.0, 0.1111111111111111  ,0.9310344827586207  ,0.0, 0.0, 0.1111111111111111  ,0.0, 0.1111111111111111  ,0.26865671641791045 ,0.1111111111111111],
                            [0.1111111111111111  ,0.0, 0.0, 0.016129032258064516,0.1111111111111111  ,0.1111111111111111  ,0.5, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.14814814814814814 ,0.15079365079365079 ,0.0, 0.0, 0.5, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.15555555555555556 ,0.15555555555555556 ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.1111111111111111],
                            [0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.1111111111111111  ,0.033582089552238806,0.1111111111111111],
                            [0.1111111111111111  ,0.0, 0.9333333333333333  ,0.9032258064516129  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 1.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,1.0, 0.1111111111111111  ,1.0, 0.0, 0.4444444444444444  ,0.47619047619047616 ,1.0, 1.0, 0.0, 0.23404255319148937 ,1.0, 0.1111111111111111  ,0.06896551724137931 ,0.6, 0.6, 0.1111111111111111  ,1.0, 0.1111111111111111  ,0.16044776119402984 ,0.1111111111111111],
                            [0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.14814814814814814 ,0.12698412698412698 ,0.0, 0.0, 0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.08888888888888889 ,0.08888888888888889 ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.1111111111111111],
                            [0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2553191489361702  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.1111111111111111  ,0.26865671641791045 ,0.1111111111111111],
                            [0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.0, 0.0, 0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.1111111111111111  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2553191489361702  ,0.0, 0.1111111111111111  ,0.0, 0.0, 0.0, 0.1111111111111111  ,0.0, 0.1111111111111111  ,0.26865671641791045 ,0.1111111111111111]],
                  evidence=['cap-surface', 'spore-print-color'],
                  evidence_card=[4,9])

cpd_ring_type = TabularCPD(variable='ring-type', variable_card=5, 
                   values= [[0.2 , 0.2 , 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 1.0 , 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 1.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0       , 0.2 , 0.2 , 0.9411764705882353  , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.0 , 0.2 , 0.8888888888888888, 0.0 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.2696629213483146, 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.0       , 0.0 , 0.2 , 0.25396825396825395 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0       , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0 , 0.0 , 0.0 , 0.225        , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.058823529411764705, 0.2 , 0.2 , 0.2] ,
                            [0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0       , 0.2 , 0.2 , 0.058823529411764705, 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0      , 0.0 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.0      , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.0       , 0.0 , 0.2 , 0.015873015873015872, 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.02702702702702703, 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0 , 0.0 , 0.0 , 0.015        , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0        , 0.2 , 0.2 , 0.2 ],
                            [0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 1.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.8181818181818182 , 0.2 , 0.2 , 0.0        , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0      , 0.0 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.0      , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.8181818181818182 , 0.0 , 0.2 , 0.0        , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0       , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0        , 0.2 , 0.2 , 0.2 ],
                            [0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0       , 0.2 , 0.2 , 0.0        , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0      , 0.0 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.0 , 0.2 , 0.0      , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.0       , 0.0 , 0.2 , 0.0        , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.0       , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 1.0 , 0.0        , 0.2 , 0.2 , 0.2] ,
                            [0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.2 , 0.2 , 0.2 , 1.0 , 1.0 , 0.0 , 1.0 , 0.2 , 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.18181818181818182, 0.2 , 0.2 , 0.0        , 0.2 , 0.2 , 0.2 , 1.0 , 0.2 , 0.2 , 1.0 , 0.2 , 0.1111111111111111, 1.0 , 0.2 , 0.2 , 1.0 , 1.0 , 0.2 , 1.0 , 0.2 , 0.7303370786516854, 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 1.0 , 0.2 , 0.2 , 0.2 , 1.0 , 1.0 , 0.18181818181818182, 1.0 , 0.2 , 0.7301587301587301  , 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 1.0 , 0.2 , 0.2 , 0.2 , 0.972972972972973  , 0.2 , 0.2 , 0.2 , 1.0 , 0.2 , 1.0 , 1.0 , 0.0 , 0.76, 1.0 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.2 , 0.0 , 0.9411764705882353  , 0.2 , 0.2 , 0.2]],
                  evidence=['gill-color', 'odor'],
                  evidence_card=[12,9])

cpd_bruises = TabularCPD(variable='bruises', variable_card=2, 
                   values= [[0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 0.5, 1.0, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0, 0.5, 0.816793893129771 , 1.0, 0.5, 0.5, 0.24342105263157895 , 0.5, 0.5, 0.5, 0.5, 0.0, 1.0, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.5],
                            [0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 1.0, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.0, 0.5, 0.183206106870229 , 0.0, 0.5, 0.5, 0.756578947368421   , 0.5, 0.5, 0.5, 0.5, 1.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5]],
                  evidence=['odor', 'ring-type'],
                  evidence_card=[9,5])

cpd_gill_size = TabularCPD(variable='gill-size', variable_card=2, 
                   values= [[0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 1.0, 0.0, 1.0, 1.0, 0.5, 0.8333333333333334  , 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.9411764705882353   , 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 1.0, 0.5, 0.8888888888888888 , 0.0, 0.5, 0.5, 0.8571428571428571  , 0.0, 0.5, 0.8571428571428571  , 0.5, 0.9662921348314607   , 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.6666666666666666 , 0.0, 1.0, 0.6666666666666666 , 0.5, 0.9523809523809523   , 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.972972972972973   , 0.5, 0.5, 0.5, 0.8571428571428571  , 0.5, 1.0, 0.8571428571428571  , 1.0, 0.87          , 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 0.9411764705882353   , 0.5, 0.5, 0.5],
                            [0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.0, 1.0, 0.0, 0.0, 0.5, 0.16666666666666666 , 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.058823529411764705 , 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.0, 0.5, 0.1111111111111111 , 1.0, 0.5, 0.5, 0.14285714285714285 , 1.0, 0.5, 0.14285714285714285 , 0.5, 0.033707865168539325 , 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3333333333333333 , 1.0, 0.0, 0.3333333333333333 , 0.5, 0.047619047619047616 , 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 0.5, 0.02702702702702703 , 0.5, 0.5, 0.5, 0.14285714285714285 , 0.5, 0.0, 0.14285714285714285 , 0.0, 0.13          , 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.058823529411764705 , 0.5, 0.5, 0.5]],
                  evidence=['gill-color', 'odor'],
                  evidence_card=[12,9])

cpd_gill_attachment = TabularCPD(variable='gill-attachment', variable_card=2, 
                   values= [[0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.0 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.15517241379310345, 0.5, 0.5, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.0, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 0.5, 0.5, 1.0, 1.0, 0.5, 0.5, 0.0, 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
                            [0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,1.0 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5, 0.5 ,0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,1.0 ,0.8448275862068966 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,1.0 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,1.0 ,1.0 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,1.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.0 ,0.5 ,0.5 ,0.0 ,0.0 ,0.5 ,0.5 ,1.0 ,0.0 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5 ,0.5]],
                  evidence=['gill-color', 'habitat', 'spore-print-color'],
                  evidence_card=[12,7,9])

cpd_class = TabularCPD(variable='class', variable_card=2, 
                   values= [[0.5,1,0,0.5], [0.5,0,1,0.5]],
                  evidence=['odor', 'ring-type', 'spore-print-color', 'gill-color'],
                  evidence_card=[2,1,2,1])
        
# model.add_cpds(cpd_cap_surface, cpd_spore_print_color, cpd_habitat, cpd_gill_color, cpd_odor, cpd_ring_type, cpd_bruises, cpd_gill_size, cpd_gill_attachment, cpd_class)
# model.check_model()
# # model.get_cpds()

# print("Nodes: ", model.nodes())
# print("Edges: ", model.edges())

# print(model.get_cpds('spore-print-color')) 
# print(model.get_cpds('odor')) 
# print(model.get_cpds('class')) 

# model.fit(data=df, estimator=BayesianEstimator, prior_type='BDeu', equivalent_sample_size=8124)
# print(model.get_cpds('class'))

# model_infer = VariableElimination(model)
# q = model_infer.query(variables=['class'], evidence={'6': 'a'})
# print(q)
# model_infer = VariableElimination(model)
# x = model_infer.query(variables=['income'], evidence={'odor':0})
# print(x)